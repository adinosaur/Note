操作系统内存分配算法
=============

在程序需要分配内存的时候，操作系统必须对其进行管理。例如当程序需要5kb的内存时，操作系统必须从空闲内存中找出大小为5kb的内存，并分配给程序。
有两种方式跟踪内存的使用情况，分别是：

* 位图
* 空闲链表

## 位图

### 定义
使用位图，内存被划分成一系列的分配单元
> 单元的大小从几个字到几千字。其中分配单元的大小设计很有考究，如果分配单元越小，分配越精细，但位图越大。如果分配单元比较大，则位图较小，
但是如果申请的内存不是单元的整数倍，则最后一个单元浪费的内存比较多。

每个存储单元对应位图中的一位，0表示这个单元是空闲的，1表示被占用。

### 分配算法
搜索位图，找出k个连续的0串

### 缺点

在决定为程序分配k个分配单元时，系统必须搜索位图找出k个连续的0的串，比较耗时。

## 空闲链表

###定义
这种方法是维护一个链表，来记录已分配内存段和空闲内存段。其中表中的一个结点或者包含一个进程，或者是两个进程的空闲区。链表通常按地址排序。

### 分配算法
通常有几种算法，分别是

* 首次适配（first fit）。搜索链表，直到找到一个足够大的空闲区。
* 下次适配 （next fit）。
* 最佳适配 （best fit）。搜索整个链表，找到满足要求最小的空闲结点。（缺点是会产生大量无用的小空闲区）。

在回收进程的内存时，如果旁边有空闲区应该合并空闲区

## 参考资料

《现代操作系统 第三版》p104-106